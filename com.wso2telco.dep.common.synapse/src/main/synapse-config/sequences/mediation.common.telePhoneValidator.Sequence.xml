<?xml version="1.0" encoding="UTF-8"?>
<sequence name="mediation.common.telephoneValidation.Sequence"
  trace="disable" xmlns="http://ws.apache.org/ns/synapse">
  <log>
    <property expression="get-property('endUserId')"
      name="validation for endUserId " xmlns:ns="http://org.apache.synapse/xsd"/>
  </log>
  <filter regex="tel:\+[a-zA-Z0-9]+" source="get-property('endUserId')" xmlns:ns="http://org.apache.synapse/xsd">
    <then/>
    <else>
      <filter regex="tel:[a-zA-Z0-9]+" source="get-property('endUserId')">
        <then/>
        <else>
          <filter regex="\+[a-zA-Z0-9]+" source="get-property('endUserId')">
            <then/>
            <else>
              <log>
                <property name="ERROR" value="returning error response"/>
              </log>
              <property name="messageId" scope="default" type="STRING" value="SVC0004"/>
              <property name="errorText" scope="default" type="STRING" value="Invalid input value for message part %1"/>
              <property name="httpStatusCode" scope="default"
                type="STRING" value="400"/>
              <property
                expression="fn:concat('endUserId Value ',get-property('endUserId'))"
                name="errorVariable" scope="default" type="STRING"/>
              <sequence key="mediation.common.response.ServiceException.Sequence"/>
            </else>
          </filter>
        </else>
      </filter>
    </else>
  </filter>
</sequence>
